<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>main-videotape</title>
  <style>
    
  </style>
</head>

<body>
  <div id="root">
    <div id="video-frame">
      <!--?<img src="./SVG/videoframe.svg" alt="videoframe">-->
      <!--!화면에 딱 맞게 제어하려면 div로 구성하는 편이 낫다-->
      <div class="videobox-con">
        <div data-box="0">테이프 들어갈 공간있는 박스</div>
        <div data-box="1">테이프 머리</div>
      </div>
      <div>
        <div class="tape-con">
          <img src="./SVG/tapeimg.svg" alt="tapeimg" width="300px" height="300px" data-move="1">
          <img src="./SVG/reelimg.svg" alt="reelimg" width="250px" height="250px" data-move="0">
        </div>
        <div class="tape-con">
          <img src="./SVG/tapeimg.svg" alt="tapeimg" width="300px" height="300px" data-move="1">
          <img src="./SVG/reelimg.svg" alt="reelimg" width="250px" height="250px" data-move="0">
        </div>
      </div>
    </div>
    <div id="tape-title"></div>
  </div>
  <script>
    // <!--*variable declaration-->
    const colorObj = {
      colorBk: '#261D23',
      colorDp: '#8C4D88',
      colorGp: '#734C70',
      colorPp: '#F2B6EE',
      colorGr: '#81798C', 
      colorFf: '#fff'
    }
    let hun = 100;
    
    function display(element, display='flex', align='center', justify='center', direction = 'row') {
      if (typeof display === 'string' && typeof align === 'string' && typeof justify === 'string') {
        element.style.display = display;
        element.style.alignItems = align;
        element.style.justifyContent = justify;
        element.style.flexDirection = direction;
        console.log(element);
      }
    }

    function size(element, width, height = null){
      // element는 조건식에서 제외해주자, 값이 문자열로 들어오면 됨
      if(typeof width === 'string'){
        element.style.width = width;
        element.style.height = height;
      } else{
        console.error('parameter is not string');
      }
    }

    function rotate(element, deg = 90){
      if(typeof deg === 'number'){
        element.style.transform = `rotate(${deg}deg)`;
      }
    }

    // <!-- *document.body -->
    document.body.setAttribute('style',`margin: 0; padding: 0;`);
    
    // <!-- *#root -->
    const root = document.getElementById('root');
    root.setAttribute('style',`width; ${hun}vw; height: ${hun}vh;`);
    
    // <!-- *#video-frame -->
    const videoCon = document.querySelector('#video-frame');
    // <!-- *#video-frame>div:nth-child(3)-->
    const tapeCon = videoCon.lastElementChild;
    // console.log(videoCon);
    // console.log(videoFr);
    // videoFr.setAttribute('style',`width: ${hun}vmin; height: ${hun}vmin; transform: rotate(${hun/10*9}deg); position: fixed;`)
    // videoFr.style.transform = `rotate(${hun/10*9}deg)`;
    console.log(tapeCon);
    tapeCon.setAttribute('style',`width: ${hun}vw; height: ${hun}vh; border: 1px solid; display: grid; align-items: center; justify-content: space-around; position: relative; right: 4vh;`);
    
    // <!--*.tape-con-->
    console.log(tapeCon.children);
    const tapeChildCon = tapeCon.children;
    // <!--?테이프 부분을 겹쳐주려면 for()이나 .forEach()를 사용하면 중첩해서 사용해줘야 한다, 아니면 첫번째 tapeChildCon에만 적용이 됐다-->
    const tapeChild = Array.from(tapeChildCon);
    // console.log(tapeChild);
    // tapeChild.forEach((con, index) => {
    //   con.children[index].style.position = 'absolute';
    // })
    // <!--*.tape-con>img를 겹쳐줄 부분-->
    for(let x = 0; x < tapeChildCon.length; x++){
      for(let i = 0; i < tapeChildCon[x].children.length; i++){
        tapeChildCon[x].children[i].style.position = 'absolute';
        // console.log(tapeChildCon[i].children[i]);
      }
    }
    // <!--?배열이 되면 칠드런 요소가 undefined로 나온다-->
    // <!--*.tape-con-->
    const wheelTapeCon = document.getElementsByClassName('tape-con');
    console.log(wheelTapeCon);
    // const wheelTapeConArr = Array.from(wheelTapeCon);
    // console.log(wheelTapeConArr);
    // wheelTapeCon.forEach(element => element.setAttribute('style',`display: flex; align-items: center; justify-content: center;`))
    for(let i = 0; i < wheelTapeCon.length; i++){
      wheelTapeCon[i].setAttribute('style',`display: flex; align-items: center; justify-content: center;`)
    }

    // <!-- *tape 돌아가는 움직임 -->
    // dataset을 넣어뒀으니까 그 이미지 태그에만 넣기
    const wheel = [
      {transform: 'rotate(0) scale(1)'},
      {transform: 'rotate(360deg) scale(1)'}
    ];
    const wheelTime = {
      duration: 3000,
      iterations: 100,
    }
    const tape = [
      {transform: 'rotate(360deg) scale(1)'},
      {transform: 'rotate(0) scale(1)'}
    ];
    const tapeTime = {
      duration: 10000,
      iterations: 100,
    }
    // <!--?되긴 되는데 직접 지정해서 하는 방식말고 다른 방식으로 작성해보기-->
    // tapeChildCon[0].children[0].animate(wheel, wheelTime);
    // tapeChildCon[1].children[0].animate(wheel, wheelTime);
    // <!--*img.dataset = '1' === alt='wheel', img.dataset = '0' === alt='tape'-->
    const imgItem = document.getElementsByTagName('img');
    console.log(imgItem);
    const img = Array.from(imgItem);
    console.log(img);
    // <!--*wheel을 굴리면 재생되는 것처럼 움직여지도록 브라우저창에 휠 이벤트-->
    window.addEventListener('wheel',function(){
      img.forEach((img, index) => {
        // data-move='1'
        if(img.dataset.move === '1'){
          img.animate(wheel, wheelTime);
        // data-move='0'
        } else{
          img.animate(tape, tapeTime);
        }
      })
    })

    // <!--*.videobox-con-->
    const videoboxCon = document.querySelector('.videobox-con');
    // <!--*data-box: 비디오 모양 박스로 구성할 태그들-->
    const videoboxItem = videoboxCon.children;
    const videobox = Array.from(videoboxItem);
    // console.log(videoboxCon);
    // console.log(videoboxItem);
    console.log(videobox);
    // <!--*.videobox-con style-->
    videoboxCon.setAttribute('style',`width: ${hun}vw; height: ${hun}vh; position: absolute; z-index: 2; display: grid; grid-template-columns: 9fr 1fr;`);
    videobox.forEach(element => {
      if(element.dataset.box === '0'){
        element.style.border = `${hun/10*9}px solid ${colorObj.colorBk}`;
        element.textContent = '';
      } else{
        element.style.background = `${colorObj.colorGp}`;
        element.textContent = '';
      }
    })

    // <!--*tape title-->
    const tapeTitle = document.getElementById('tape-title');
    console.log(tapeTitle);
    tapeTitle.setAttribute('style',`width: ${hun}vw; height: ${hun}vh; position: absolute; top: 0; z-index: 2;`);
    // display속성과 그 외의 속성을 조절해주는 함수 display calling
    display(tapeTitle);

    function appendName(element){
      if(element.tagName !== null && element.tagName !== ''){
        return element.tagName;
      }
    }
    const tapeTitleBg = document.createElement(appendName(tapeTitle)); 
    console.dir(tapeTitleBg);
    tapeTitleBg.classList = 'tape-bg-con';
    tapeTitle.appendChild(tapeTitleBg); //자식요소로 div가 생겼다
    console.log(tapeTitle);

    // <!--todo: append한 자식요소를 식별하기 => titleBg-->
    // title img와 div text를 감싸는 컨테이너 배경 부분
    const titleBg = document.querySelector('.tape-bg-con');
    console.log(titleBg);
    display(titleBg);
    // <!--todo: 배경 크기 스타일링-->
    titleBg.setAttribute('style',`width: ${hun/2}vw; height: ${hun/2}vh; background: ${colorObj.colorFf}`);

    // <!--todo: titleBg>img(로고)+div(한글 더 발룬티어스)-->
    // prepend할 img태그 심어주기
    const makeImg = document.createElement('img');
    const makeTitle = document.createElement(appendName(tapeTitleBg));
    makeImg.src = './SVG/tapename.png';
    // 회전 조절 function calling -> rotate(element, deg = 90);
    rotate(makeImg);
    // 사이즈를 function calling -> size(element, width, height);
    size(makeImg, `${hun/1}vw`);
    makeTitle.textContent = ':더 발룬티어스';
    // prepend(img+div)
    titleBg.append(makeImg, makeTitle);
    


  </script>
</body>

</html>